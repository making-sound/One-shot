#N canvas 483 113 707 509 12;
#X declare -path samples;
#X floatatom 96 105 0 0 0 0 - - -;
#X obj 60 79 notein;
#X floatatom 60 105 0 0 0 0 - - -;
#X floatatom 132 105 0 0 0 0 - - -;
#X obj 237 45 bng 15 250 50 0 empty empty empty 17 7 0 10 -262144 -1
-1;
#N canvas 180 80 894 533 read_and_process 0;
#X obj 227 275 cyclone/coll keymap;
#C restore;
#X obj 227 306 list prepend;
#X msg 227 236 dump;
#X obj 312 364 f;
#X obj 344 365 + 1;
#X obj 227 394 list append;
#X msg 331 339 0;
#X obj 227 333 t l b;
#X obj 226 210 t b b;
#X msg 118 101 read keymap.txt;
#X obj 225 187 bng 15 250 50 0 empty empty empty 17 7 0 10 -262144
-1 -1;
#X text 242 184 append buf ids;
#X obj 129 61 t b b;
#X obj 226 487 cyclone/coll keymap2;
#C restore;
#X obj 227 419 list prepend store;
#X obj 227 444 list trim;
#X msg 319 452 clear;
#X obj 127 28 inlet;
#X obj 117 130 cyclone/coll keymap;
#C restore;
#X obj 221 165 bng 15 250 50 0 empty empty empty 17 7 0 10 -262144
-1 -1;
#X obj 515 65 bng 15 250 50 0 empty empty empty 17 7 0 10 -262144 -1
-1;
#X obj 499 142 coll keymap;
#C restore;
#X msg 499 118 channel;
#X obj 499 181 s channel_set;
#X obj 616 143 coll keymap;
#C restore;
#X msg 616 119 fade_dur;
#X obj 616 182 s fade_dur_set;
#X connect 0 0 1 0;
#X connect 0 1 1 1;
#X connect 1 0 7 0;
#X connect 2 0 0 0;
#X connect 3 0 4 0;
#X connect 3 0 5 1;
#X connect 4 0 3 1;
#X connect 5 0 14 0;
#X connect 6 0 3 1;
#X connect 7 0 5 0;
#X connect 7 1 3 0;
#X connect 8 0 2 0;
#X connect 8 1 6 0;
#X connect 8 1 16 0;
#X connect 9 0 18 0;
#X connect 10 0 8 0;
#X connect 12 0 9 0;
#X connect 12 1 20 0;
#X connect 14 0 15 0;
#X connect 15 0 13 0;
#X connect 16 0 13 0;
#X connect 17 0 12 0;
#X connect 18 2 19 0;
#X connect 19 0 10 0;
#X connect 20 0 22 0;
#X connect 20 0 25 0;
#X connect 21 0 23 0;
#X connect 22 0 21 0;
#X connect 24 0 26 0;
#X connect 25 0 24 0;
#X restore 237 70 pd read_and_process;
#X obj 423 74 declare -path samples;
#X obj 238 108 bng 15 250 50 0 empty empty empty 17 7 0 10 -262144
-1 -1;
#X obj 238 160 bng 15 250 50 0 empty empty empty 17 7 0 10 -262144
-1 -1;
#X text 253 157 done;
#X text 255 105 load buffers;
#N canvas 471 23 599 709 load_buffers 0;
#X obj 184 20 inlet;
#X obj 163 137 cyclone/coll keymap2;
#C restore;
#X obj 162 446 soundfiler;
#X text 251 297 filename \, buf id;
#X obj 163 166 list;
#X obj 162 301 unpack s f;
#X obj 238 334 makefilename buf%d;
#X obj 162 359 pack s s;
#X obj 162 387 list prepend read -resize;
#X obj 162 414 list trim;
#X obj 87 620 f;
#X obj 120 621 + 1;
#X msg 192 94 start;
#X obj 87 647 moses 4;
#X msg 108 595 0;
#X obj 183 50 t b b;
#X obj 27 358 t b;
#X msg 143 92 next;
#X obj 135 700 outlet;
#X obj 136 674 b;
#X floatatom 163 473 8 0 0 0 - - -, f 8;
#X obj 161 272 t l l;
#X obj 198 565 list prepend;
#X obj 198 598 list prepend;
#X obj 198 637 list prepend store;
#X obj 198 662 list trim;
#X obj 198 702 coll keymap3;
#C restore;
#X msg 306 704 clear;
#X obj 163 542 t b f;
#X text 321 603 append length;
#X obj 165 503 moses 0.5;
#X obj 248 50 bng 15 250 50 0 empty empty empty 17 7 0 10 -262144 -1
-1;
#X connect 0 0 15 0;
#X connect 1 0 4 0;
#X connect 1 1 23 1;
#X connect 2 0 20 0;
#X connect 4 0 21 0;
#X connect 5 0 7 0;
#X connect 5 1 6 0;
#X connect 6 0 7 1;
#X connect 7 0 8 0;
#X connect 8 0 9 0;
#X connect 9 0 2 0;
#X connect 10 0 11 0;
#X connect 10 0 13 0;
#X connect 11 0 10 1;
#X connect 12 0 1 0;
#X connect 13 0 16 0;
#X connect 13 1 19 0;
#X connect 14 0 10 1;
#X connect 15 0 17 0;
#X connect 15 1 14 0;
#X connect 15 1 12 0;
#X connect 15 1 27 0;
#X connect 16 0 17 0;
#X connect 17 0 1 0;
#X connect 19 0 18 0;
#X connect 20 0 30 0;
#X connect 21 0 5 0;
#X connect 21 1 22 1;
#X connect 22 0 23 0;
#X connect 23 0 24 0;
#X connect 24 0 25 0;
#X connect 25 0 26 0;
#X connect 27 0 26 0;
#X connect 28 0 10 0;
#X connect 28 1 22 0;
#X connect 30 1 28 0;
#X connect 31 0 15 0;
#X restore 238 131 pd load_buffers;
#X text 256 45 read keymap file;
#N canvas 286 84 450 407 midi_in 0;
#X obj 50 72 notein;
#X obj 50 109 stripnote;
#X floatatom 170 87 5 0 0 0 - - -, f 5;
#X obj 50 171 spigot;
#X obj 50 137 pack f f;
#X text 153 65 set channel;
#X obj 50 199 unpack f f;
#X obj 50 256 list append;
#X obj 48 352 outlet;
#X obj 50 228 cyclone/coll keymap3;
#C restore;
#X text 150 347 buf id \, length \, vel;
#X msg 49 319 \$2 \$3 \$4;
#X obj 182 29 r channel;
#X obj 147 116 == 1;
#X connect 0 0 1 0;
#X connect 0 1 1 1;
#X connect 0 2 13 0;
#X connect 1 0 4 0;
#X connect 1 1 4 1;
#X connect 2 0 13 1;
#X connect 3 0 6 0;
#X connect 4 0 3 0;
#X connect 6 0 9 0;
#X connect 6 1 7 1;
#X connect 7 0 11 0;
#X connect 9 0 7 0;
#X connect 11 0 8 0;
#X connect 12 0 2 0;
#X connect 13 0 3 1;
#X restore 67 236 pd midi_in;
#X text 12 8 Requires cyclone/coll;
#X obj 215 211 jg/dspstate;
#X text 35 266 buf id \, length \, vel;
#X text 397 284 voice stealing on/off;
#X text 396 329 key debounce;
#X text 396 306 ignore consecutives;
#X text 401 350 all off;
#X text 402 370 program change folders;
#X text 398 395 velocity sensitive on/off;
#N canvas 0 23 564 417 voice_allocation 0;
#X obj 87 38 inlet;
#X floatatom 86 213 5 0 0 0 - - -, f 5;
#X text 129 211 voice;
#N canvas 398 69 601 553 get_voice 0;
#X floatatom 150 129 5 0 0 0 - - -, f 5;
#X text 191 128 id;
#X floatatom 433 154 5 0 0 0 - - -, f 5;
#X obj 151 78 unpack f f f;
#X floatatom 322 154 5 0 0 0 - - -, f 5;
#X text 363 153 length;
#X obj 189 214 + 1;
#X obj 151 230 f;
#X floatatom 152 285 5 0 0 0 - - -, f 5;
#X text 196 285 unique 'pitch';
#X text 480 152 vel;
#X floatatom 322 267 8 0 0 0 - - -, f 8;
#X text 390 265 dur (ms);
#X obj 152 386 stripnote;
#X floatatom 152 419 5 0 0 0 - - -, f 5;
#X text 196 417 voice;
#X obj 150 173 t b f;
#X obj 154 41 inlet;
#X obj 152 494 outlet;
#X obj 280 357 expr if($f1>0 \, 1 \, -1);
#X obj 278 422 f;
#X obj 309 421 + 1;
#X obj 279 387 t b f;
#X floatatom 300 463 5 0 0 0 - - -, f 5;
#X text 344 462 active voices;
#X obj 299 495 outlet;
#N canvas 0 23 260 316 samps_to_ms 0;
#X obj 39 26 inlet;
#X obj 106 94 samplerate~;
#X obj 106 67 r pd-dsp-started;
#X floatatom 106 121 7 0 0 0 - - -, f 7;
#X obj 32 179 /;
#X obj 102 144 / 1000;
#X obj 32 204 outlet;
#X connect 0 0 4 0;
#X connect 1 0 3 0;
#X connect 2 0 1 0;
#X connect 3 0 5 0;
#X connect 4 0 6 0;
#X connect 5 0 4 1;
#X restore 322 239 pd samps_to_ms;
#X msg 51 288 stop;
#X obj 51 264 r all_off;
#X obj 189 240 mod 128;
#X obj 152 313 makenote 64 1000;
#X obj 152 341 poly 36 0;
#X connect 0 0 16 0;
#X connect 3 0 0 0;
#X connect 3 1 4 0;
#X connect 3 2 2 0;
#X connect 4 0 26 0;
#X connect 6 0 29 0;
#X connect 7 0 6 0;
#X connect 7 0 8 0;
#X connect 8 0 30 0;
#X connect 11 0 30 2;
#X connect 13 0 14 0;
#X connect 14 0 18 0;
#X connect 16 0 7 0;
#X connect 17 0 3 0;
#X connect 19 0 22 0;
#X connect 20 0 21 0;
#X connect 21 0 20 1;
#X connect 21 0 23 0;
#X connect 22 0 20 0;
#X connect 22 1 21 1;
#X connect 23 0 25 0;
#X connect 26 0 11 0;
#X connect 27 0 31 0;
#X connect 28 0 27 0;
#X connect 29 0 7 1;
#X connect 30 0 31 0;
#X connect 30 1 31 1;
#X connect 31 0 13 0;
#X connect 31 2 13 1;
#X connect 31 2 19 0;
#X restore 86 183 pd get_voice;
#X obj 86 154 t l l;
#X text 31 277 voice \, buf id \, length \, vel;
#N canvas 0 23 450 300 voice_minus_1 0;
#X obj 52 55 list split 1;
#X obj 52 81 - 1;
#X obj 52 106 list append;
#X obj 52 24 inlet;
#X obj 52 131 outlet;
#X connect 0 0 1 0;
#X connect 0 1 2 1;
#X connect 1 0 2 0;
#X connect 2 0 4 0;
#X connect 3 0 0 0;
#X restore 86 302 pd voice_minus_1;
#X floatatom 310 272 5 0 0 0 - - -, f 5;
#X obj 86 339 outlet;
#X obj 310 341 outlet;
#X text 354 272 num voices;
#X obj 188 20 r all_off;
#X obj 293 21 r fade_dur;
#X obj 270 55 del;
#X obj 85 108 spigot 1;
#X msg 188 80 0;
#X msg 270 80 1;
#X obj 86 239 list append;
#X text 12 68 buf id \, length \, vel;
#X connect 0 0 14 0;
#X connect 1 0 17 0;
#X connect 3 0 1 0;
#X connect 3 1 7 0;
#X connect 4 0 3 0;
#X connect 4 1 17 1;
#X connect 6 0 8 0;
#X connect 7 0 9 0;
#X connect 11 0 15 0;
#X connect 11 0 13 0;
#X connect 12 0 13 1;
#X connect 13 0 16 0;
#X connect 14 0 4 0;
#X connect 15 0 14 1;
#X connect 16 0 14 1;
#X connect 17 0 6 0;
#X restore 65 322 pd voice_allocation;
#X text 260 346 num voices;
#X floatatom 213 348 5 0 0 0 - - -, f 5;
#X obj 216 369 hsl 128 15 0 36 0 0 empty empty empty -2 -8 0 10 -262144
-1 -1 0 1;
#X obj 64 437 dac~ 1 2;
#X floatatom 435 195 5 0 0 0 - fade_dur_set fade_dur, f 5;
#X obj 569 143 bng 30 250 50 0 all_off empty empty 17 7 0 10 -262144
-1 -1;
#X text 538 172 all notes off;
#X obj 64 392 clone oneshotsampler 36;
#X text 396 420 stereo/multichannel files;
#X floatatom 432 142 5 1 16 0 - channel_set channel, f 5;
#X text 415 120 set channel;
#X text 407 174 fade dur (ms);
#X text 401 444 all notes off midi note trigger;
#X connect 1 0 2 0;
#X connect 1 1 0 0;
#X connect 1 2 3 0;
#X connect 4 0 5 0;
#X connect 7 0 11 0;
#X connect 11 0 8 0;
#X connect 13 0 23 0;
#X connect 23 0 31 0;
#X connect 23 1 25 0;
#X connect 25 0 26 0;
#X connect 31 0 27 0;
#X connect 31 0 27 1;
